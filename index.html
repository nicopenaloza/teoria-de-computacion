<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulador de Máquina de Turing (Editor Visual)</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app" aria-labelledby="appTitle">
      <header class="app-header">
        <h1 id="appTitle">Simulador de Máquina de Turing</h1>
        <p>Editor visual multcinta con creación de estados y transiciones desde el diagrama.</p>
      </header>

      <div class="workspace">
        <section class="panel editor" aria-labelledby="editorTitle">
          <div class="section-head">
            <h2 id="editorTitle">Diagrama</h2>
            <div class="actions compact">
              <button id="addState" type="button" title="Crear estado (N)">Estado</button>
              <button id="setStart" type="button" title="Marcar inicio (I)">Inicio</button>
              <button id="toggleAccept" type="button" title="Alternar aceptación (A)">Aceptación</button>
              <button id="deleteState" type="button" title="Eliminar estado (Supr)">Eliminar</button>
              <button id="loadExample" type="button">Ejemplo</button>
            </div>
          </div>

          <p id="graphInstructions" class="hint">
            Mouse: doble clic crea/edita, Shift+arrastrar crea flecha. Teclado: N nuevo, I inicio, A aceptación, Supr eliminar, E editar transición, flechas mueve estado.
          </p>
          <p class="hint">Estado: <strong id="selectedState">(ninguno)</strong> · Flecha: <strong id="selectedTransition">(ninguna)</strong></p>

          <div
            id="stateGraph"
            class="state-graph"
            role="application"
            tabindex="0"
            aria-describedby="graphInstructions"
            aria-label="Editor de diagrama de estados"
          ></div>

          <div id="tapeArea" class="tape-cards" aria-live="polite"></div>

          <details class="advanced advanced-under-graph">
            <summary>Edición avanzada de transiciones</summary>
            <p class="hint">Formato: <code>e0 (>,>) -> (->, ->, e0)</code></p>

            <label for="transitionInput">
              Editor rápido (una transición)
              <input
                id="transitionInput"
                type="text"
                spellcheck="false"
                placeholder="e0 (>,>) -> (->, 1->, e1)"
              />
            </label>
            <div class="actions compact">
              <button id="saveTransition" type="button">Guardar</button>
              <button id="deleteTransition" type="button">Eliminar flecha</button>
              <button id="clearTransition" type="button">Limpiar</button>
            </div>

            <div class="table-wrap" aria-label="Tabla editable de transiciones">
              <table id="transitionsTable" class="transitions-table">
                <thead id="transitionsTableHead"></thead>
                <tbody id="transitionsTableBody"></tbody>
              </table>
            </div>
            <div class="actions compact">
              <button id="addTransitionRow" type="button">Agregar fila</button>
              <button id="deleteTransitionRow" type="button">Eliminar fila</button>
              <button id="applyTransitionTable" type="button">Aplicar tabla</button>
            </div>

            <label for="transitionsPreview">
              Texto crudo (opcional)
              <textarea id="transitionsPreview" rows="4" spellcheck="false"></textarea>
            </label>
          </details>
        </section>

        <aside class="side-column">
          <section class="panel config" aria-labelledby="configTitle">
            <h2 id="configTitle">Configuración</h2>

            <label for="tapeCount">
              Cantidad de cintas
              <input id="tapeCount" type="number" min="1" step="1" value="2" />
            </label>

            <div id="initialTapesEditor" class="tapes-config" aria-label="Editor de cintas iniciales"></div>
            <p class="hint">Solo la Cinta 1 es editable manualmente. Las demás son cintas infinitas (inician con <code>></code>).</p>

            <div class="actions compact">
              <button id="initialize" type="button">Inicializar</button>
              <button id="reset" type="button">Reiniciar</button>
            </div>
          </section>

          <section class="panel simulation" aria-labelledby="simTitle">
            <h2 id="simTitle">Simulación</h2>
            <div class="controls">
              <button id="step" type="button" disabled>Paso</button>
              <button id="run" type="button" disabled>Ejecutar</button>
              <button id="pause" type="button" disabled>Pausar</button>
              <label for="speed">Velocidad</label>
              <input id="speed" type="range" min="50" max="1000" step="50" value="300" />
              <output id="speedValue" for="speed">300 ms</output>
            </div>

            <div class="status" aria-live="polite">
              <p><strong>Estado:</strong> <span id="currentState">-</span></p>
              <p><strong>Paso:</strong> <span id="stepCount">0</span></p>
              <p><strong>Mensaje:</strong> <span id="message" role="status">Crea el diagrama e inicializa la máquina.</span></p>
            </div>
          </section>
        </aside>
      </div>
    </main>

    <script src="app.js"></script>
  </body>
</html>
